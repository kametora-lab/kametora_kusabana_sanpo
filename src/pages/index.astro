---
import Layout from '../layouts/Layout.astro';
import plants from '../data/plants.json';

const featuredPlants = plants.slice(0, 12);

const getImageSrc = (images) => {
	if (!images || images.length === 0) return '';
	const first = images[0];
	return typeof first === 'string' ? first : first.src;
};

const galleryPattern = [
	'md:col-span-2 md:row-span-2',
	'',
	'md:row-span-2',
	'md:col-span-2',
	'',
	'md:row-span-2',
	'',
];

// Uneven rhythm for the gallery grid (plantica-like balance).
const getGalleryClass = (index) => galleryPattern[index % galleryPattern.length];
---

<Layout title="奄美の草花さんぽ帖" description="奄美大島で出会った草花の記録。">
	<main class="min-h-screen px-6 pb-20 md:px-10 lg:px-16">
		<section class="max-w-4xl space-y-5 pt-6 md:pt-10">
			<p class="text-xs tracking-[0.4em] text-neutral-500 md:text-sm">AMAMI FLORA ARCHIVE</p>
			<h1 class="font-serif text-4xl leading-tight tracking-tight md:text-6xl">
				奄美の草花さんぽ帖
			</h1>
			<div class="space-y-1">
				<p class="text-base text-neutral-400 md:text-lg">
					奄美大島で出会った草花の記録。
				</p>
				<p class="text-base text-neutral-400 md:text-lg">
					世界自然遺産の島、奄美大島で草花を探して記録しています。
				</p>
			</div>
			<div class="pt-4">
				<a href="/kametora_kusabana_sanpo/plants" class="text-sm text-neutral-400 hover:text-neutral-200">
					草花一覧を見る →
				</a>
			</div>
		</section>

		<section class="mt-12 md:mt-20">
			<div class="grid auto-rows-[140px] grid-cols-2 gap-4 md:auto-rows-[200px] md:grid-cols-4 md:gap-6">
				{featuredPlants.map((plant, index) => (
					<a
						href={`/kametora_kusabana_sanpo/plants/${plant.slug}`}
						class={`group relative block overflow-hidden ${getGalleryClass(index)}`}
					>
						{getImageSrc(plant.images) ? (
							<img
								src={getImageSrc(plant.images)}
								alt={plant.title}
								class="h-full w-full object-cover transition-opacity duration-300 group-hover:opacity-85"
								loading="lazy"
								decoding="async"
							/>
						) : (
							<div class="flex h-full w-full items-center justify-center bg-[#111] text-xs text-neutral-600">
								NO IMAGE
							</div>
						)}
						<div class="absolute inset-0 flex items-end opacity-0 transition-opacity duration-300 group-hover:opacity-100">
							<div class="w-full bg-black/60 px-3 py-2 text-xs text-neutral-200">
								<div class="font-serif">{plant.title}</div>
								{plant.meta?.scientificName && (
									<div class="text-[11px] text-neutral-400">{plant.meta.scientificName}</div>
								)}
							</div>
						</div>
					</a>
				))}
			</div>
		</section>
	</main>
</Layout>


