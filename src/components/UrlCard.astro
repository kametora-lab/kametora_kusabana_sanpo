---
const { url, title, image } = Astro.props as {
  url: string;
  title?: string;
  image?: string;
};

const getHostname = (value: string) => {
  try {
    return new URL(value).hostname.replace(/^www\./, '');
  } catch {
    return value;
  }
};

const getPathLabel = (value: string) => {
  try {
    const parsed = new URL(value);
    return parsed.pathname === '/' ? parsed.hostname : `${parsed.hostname}${parsed.pathname}`;
  } catch {
    return value;
  }
};

const hostname = getHostname(url);
const pathLabel = getPathLabel(url);
---

<a
  href={url}
  target="_blank"
  rel="noopener noreferrer"
  class="group block border border-white/10 bg-[#0f0f0f] hover:border-white/30 transition-colors"
>
  <div class="flex items-center gap-4 p-4">
    <div class="h-16 w-16 shrink-0 border border-white/10 bg-black overflow-hidden flex items-center justify-center text-xs text-neutral-500">
      {image ? (
        <img
          src={image}
          alt=""
          class="h-full w-full object-cover"
          loading="lazy"
          decoding="async"
        />
      ) : (
        'LINK'
      )}
    </div>
    <div class="min-w-0">
      <div class="text-sm text-neutral-100 truncate font-serif">{title || hostname}</div>
      <div class="text-xs text-neutral-500 truncate">{pathLabel}</div>
    </div>
    <div class="ml-auto text-xs text-neutral-500">â†—</div>
  </div>
</a>
